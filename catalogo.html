<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>JQ Motors - Catálogo Refacciones Bajaj</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --guinda:#7B1E1E;
  --guinda-osc:#5a1414;
  --neon:#ff4d4d;
  --fondo:#111;
}

/* ===== GENERAL ===== */
body{
  margin:0;
  font-family:Montserrat,sans-serif;
  background:var(--fondo);
  color:#eee;
}

/* ===== NAVBAR ===== */
header.navbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:var(--guinda);
  padding:10px 18px;
  position:sticky;
  top:0;
  z-index:1100;
}

.logo{
  display:flex;
  align-items:center;
  gap:12px;
}
.logo img{height:64px;}
.logo h1{margin:0;font-size:1rem;color:#fff;}

/* ===== CONTENIDO ===== */
.page-header{text-align:center;padding:20px;}
.search-container{text-align:center;margin:20px;}
.search-container input{
  padding:10px 15px;
  border-radius:8px;
  border:none;
  font-size:1rem;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:20px;
  padding:20px;
  max-width:1400px;
  margin:auto;
}

.card{
  background:#fff;
  color:#000;
  border-radius:12px;
  overflow:hidden;
  cursor:pointer;
  transition:.25s;
  box-shadow:0 6px 15px rgba(0,0,0,.4);
}
.card:hover{transform:translateY(-6px);}
.card img{
  width:100%;
  height:180px;
  object-fit:contain;
  background:#f4f4f4;
}
.card p{
  margin:0;
  padding:12px;
  font-weight:600;
  color:var(--guinda);
  text-align:center;
}

.hidden{display:none;}
.back{
  display:block;
  margin:15px auto;
  padding:10px 18px;
  border:none;
  background:var(--guinda);
  color:#fff;
  border-radius:6px;
}

/* ===== OVERLAY ===== */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.95);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
}

.overlay span{
  position:absolute;
  top:20px;
  right:30px;
  font-size:32px;
  cursor:pointer;
}

.overlay-content{
  display:flex;
  gap:20px;
  width:95%;
  height:95%;
}

.img-wrap{
  flex:2;
  position:relative;
}
.img-wrap img{
  max-width:100%;
  max-height:100%;
}

.hotspot{
  position:absolute;
  border:2px solid rgba(255,77,77,.9);
  background:rgba(255,77,77,.25);
  box-shadow:0 0 12px rgba(255,77,77,.9);
  display:none;
  pointer-events:none;
}

.info-panel{
  flex:1;
  background:#111;
  border-radius:10px;
  padding:15px;
  overflow:auto;
}

.info-panel table{
  width:100%;
  border-collapse:collapse;
  font-size:.9rem;
}
.info-panel th,.info-panel td{
  border-bottom:1px solid #333;
  padding:6px;
}
.info-panel tr:hover{
  background:#222;
  cursor:pointer;
}

/* ===== SELECCIÓN PONVA ===== */
.tr-selected{
  background:#7B1E1E !important;
  color:#fff;
}
.tr-selected:hover{
  background:#5a1414 !important;
}
</style>
</head>

<body>

<header class="navbar">
  <div class="logo">
    <img src="images/logo/logo.png">
    <h1>JQ RODANDO MOMENTOS</h1>
  </div>
</header>

<header class="page-header">
  <h1>JQ Motors - Catálogo de Refacciones Bajaj</h1>
</header>

<div class="search-container">
  <input type="text" id="buscador" placeholder="Buscar moto...">
</div>

<section id="nivelMotos">
  <div class="grid" id="gridMotos"></div>
</section>

<section id="nivelSistemas" class="hidden">
  <button class="back" onclick="volverMotos()">← Volver a motos</button>
  <h2 id="tituloSistemas"></h2>
  <div class="grid" id="gridSistemas"></div>
</section>

<!-- OVERLAY -->
<div class="overlay" id="overlay">
  <span onclick="cerrarImagen()">✕</span>
  <div class="overlay-content">
    <div class="img-wrap" id="imgWrap">
      <img id="imgFull">
    </div>
    <div class="info-panel">
      <h3>Refacciones del sistema</h3>
      <table>
        <thead>
          <tr>
            <th>Código</th>
            <th>Descripción</th>
            <th>Cant.</th>
          </tr>
        </thead>
        <tbody id="tablaPiezas"></tbody>
      </table>
    </div>
  </div>
</div>

<script>
/* ===== CATÁLOGO (EJEMPLO BASE) ===== */
const catalogo={
  DOM400:{
    nombre:"Dominar 400",
    img:"images/motos/dom400-agua.png",
    sistemas:[
      {
        nombre:"Cabeza",
        img:"images/sistemas/DOM400/cabeza.png",
        piezas:[
          {codigo:"BAJ-1001",desc:"Válvula admisión",qty:2,zona:{x:42,y:30,w:8,h:12}},
          {codigo:"BAJ-1002",desc:"Válvula escape",qty:2,zona:{x:52,y:30,w:8,h:12}},
          {codigo:"BAJ-1003",desc:"Empaque de cabeza",qty:1}
        ]
      }
    ]
  }
};

/* ===== REFERENCIAS ===== */
const gridMotos=document.getElementById("gridMotos");
const gridSistemas=document.getElementById("gridSistemas");
const nivelMotos=document.getElementById("nivelMotos");
const nivelSistemas=document.getElementById("nivelSistemas");
const tituloSistemas=document.getElementById("tituloSistemas");
const overlay=document.getElementById("overlay");
const imgFull=document.getElementById("imgFull");
const imgWrap=document.getElementById("imgWrap");
const tablaPiezas=document.getElementById("tablaPiezas");

/* ===== PONVA STORAGE ===== */
function keyPonva(sistema,codigo){
  return `ponva_${sistema.nombre}_${codigo}`;
}
function isPonva(sistema,codigo){
  return localStorage.getItem(keyPonva(sistema,codigo))==="1";
}
function togglePonva(sistema,codigo){
  const k=keyPonva(sistema,codigo);
  if(localStorage.getItem(k)==="1"){
    localStorage.removeItem(k);
  }else{
    localStorage.setItem(k,"1");
  }
}

/* ===== FUNCIONES ===== */
function cargarMotos(filter=""){
  gridMotos.innerHTML="";
  nivelMotos.classList.remove("hidden");
  nivelSistemas.classList.add("hidden");

  Object.values(catalogo).forEach(m=>{
    if(filter && !m.nombre.toLowerCase().includes(filter.toLowerCase()))return;
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`<img src="${m.img}"><p>${m.nombre}</p>`;
    c.onclick=()=>cargarSistemas(m);
    gridMotos.appendChild(c);
  });
}

function cargarSistemas(moto){
  gridSistemas.innerHTML="";
  nivelMotos.classList.add("hidden");
  nivelSistemas.classList.remove("hidden");
  tituloSistemas.textContent=moto.nombre;

  moto.sistemas.forEach(s=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`<img src="${s.img}"><p>${s.nombre}</p>`;
    c.onclick=()=>verImagenSistema(s);
    gridSistemas.appendChild(c);
  });
}

function verImagenSistema(sistema){
  overlay.style.display="flex";
  imgFull.src=sistema.img;
  tablaPiezas.innerHTML="";
  imgWrap.querySelectorAll(".hotspot").forEach(h=>h.remove());

  sistema.piezas.forEach(p=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${p.codigo}</td><td>${p.desc}</td><td>${p.qty}</td>`;

    if(isPonva(sistema,p.codigo)){
      tr.classList.add("tr-selected");
    }

    tr.onclick=()=>{
      togglePonva(sistema,p.codigo);
      tr.classList.toggle("tr-selected");
    };

    tablaPiezas.appendChild(tr);

    if(p.zona){
      const h=document.createElement("div");
      h.className="hotspot";
      h.style.left=p.zona.x+"%";
      h.style.top=p.zona.y+"%";
      h.style.width=p.zona.w+"%";
      h.style.height=p.zona.h+"%";
      imgWrap.appendChild(h);

      tr.onmouseenter=()=>h.style.display="block";
      tr.onmouseleave=()=>h.style.display="none";
    }
  });
}

function cerrarImagen(){
  overlay.style.display="none";
  imgFull.src="";
}

function volverMotos(){cargarMotos();}

document.getElementById("buscador")
.addEventListener("input",e=>cargarMotos(e.target.value));

cargarMotos();
</script>

</body>
</html>
