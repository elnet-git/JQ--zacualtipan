<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>JQ Motors | Cat√°logo Refacciones</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --guinda:#7B1E1E;
  --guinda-osc:#5a1414;
  --neon:#ff4d4d;
  --neon-shadow:0 0 5px var(--neon),0 0 10px var(--neon),0 0 20px var(--neon);
  --fondo:#111;
}

body{
  margin:0;
  font-family:'Montserrat',sans-serif;
  background:var(--fondo);
  color:#eee;
}

header{
  background:var(--guinda);
  padding:10px 20px;
  box-shadow:0 4px 18px rgba(0,0,0,.5);
}

header h1{
  margin:0;
  text-shadow:var(--neon-shadow);
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  gap:20px;
  padding:20px;
}

.card{
  background:#fff;
  border-radius:14px;
  overflow:hidden;
  cursor:pointer;
  transition:.25s;
}

.card:hover{
  transform:translateY(-6px);
  box-shadow:var(--neon-shadow);
}

.card img{
  width:100%;
  height:160px;
  object-fit:contain;
  background:#f4f4f4;
}

.card p{
  text-align:center;
  font-weight:700;
  color:var(--guinda);
}

.hidden{display:none}

/* OVERLAY */
.overlay{
  position:fixed;
  inset:0;
  background:#000d;
  display:none;
  z-index:2000;
}

.overlay-content{
  display:flex;
  height:100%;
}

.img-zone{
  flex:2;
  position:relative;
}

#imgBase{
  width:100%;
  height:100%;
  object-fit:contain;
}

canvas{
  position:absolute;
  inset:0;
}

.data{
  flex:1;
  background:#111;
  padding:14px;
  overflow:auto;
  border-left:2px solid #333;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

td,th{
  border-bottom:1px solid #333;
  padding:6px;
}

.admin-btn{
  width:100%;
  padding:10px;
  margin-top:8px;
  border:none;
  border-radius:8px;
  background:var(--guinda);
  color:#fff;
  font-weight:700;
  cursor:pointer;
}

.admin-btn:hover{
  background:var(--guinda-osc);
  box-shadow:var(--neon-shadow);
}

.gray{background:#444}

input{
  width:100%;
  padding:8px;
  margin-bottom:6px;
  border-radius:6px;
  border:none;
}

.close{
  position:absolute;
  top:10px;
  right:20px;
  font-size:30px;
  cursor:pointer;
}
</style>
</head>

<body>

<header>
  <h1>JQ MOTORS</h1>
</header>

<section id="motos">
  <div class="grid" id="gridMotos"></div>
</section>

<section id="sistemas" class="hidden">
  <button class="admin-btn" onclick="volver()">‚Üê Volver</button>
  <h2 id="titulo" style="padding-left:20px"></h2>
  <div class="grid" id="gridSistemas"></div>
</section>

<div class="overlay" id="overlay">
  <span class="close" onclick="cerrar()">‚úï</span>
  <div class="overlay-content">
    <div class="img-zone">
      <img id="imgBase">
      <canvas id="canvas"></canvas>
    </div>
    <div class="data">
      <h3>Piezas</h3>
      <table>
        <thead><tr><th>C√≥digo</th><th>Descripci√≥n</th><th>Cant.</th></tr></thead>
        <tbody id="tabla"></tbody>
      </table>

      <div id="loginAdmin">
        <input id="passAdmin" type="password" placeholder="Contrase√±a ADMIN">
        <button class="admin-btn" onclick="loginAdmin()">Entrar ADMIN</button>
      </div>

      <button id="salirAdminBtn" class="admin-btn gray hidden" onclick="salirAdmin()">Salir ADMIN</button>

      <div id="adminPanel" class="hidden">
        <input id="codigo" placeholder="C√≥digo">
        <input id="desc" placeholder="Descripci√≥n">
        <input id="cant" placeholder="Cantidad">
        <button class="admin-btn" onclick="guardarZona()">Guardar zona</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ================= CAT√ÅLOGO ================= */
const catalogo = /* üëá TU CAT√ÅLOGO TAL CUAL */ 
<?js
// (El navegador ignora esto, es solo para claridad aqu√≠)
?>

/* ================= L√ìGICA ================= */
const gridMotos=document.getElementById("gridMotos");
const gridSistemas=document.getElementById("gridSistemas");
const tabla=document.getElementById("tabla");
const imgBase=document.getElementById("imgBase");
const overlay=document.getElementById("overlay");
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

let motoActual="",sistemaActual="",admin=false,dibujando=false,puntos=[],zonas=[];

/* Cargar motos */
Object.keys(catalogo).forEach(id=>{
  const c=document.createElement("div");
  c.className="card";
  c.innerHTML=`<img src="${catalogo[id].img}"><p>${catalogo[id].nombre}</p>`;
  c.onclick=()=>cargarSistemas(id);
  gridMotos.appendChild(c);
});

function cargarSistemas(id){
  motoActual=id;
  document.getElementById("motos").classList.add("hidden");
  document.getElementById("sistemas").classList.remove("hidden");
  document.getElementById("titulo").textContent=catalogo[id].nombre;
  gridSistemas.innerHTML="";
  catalogo[id].sistemas.forEach(s=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=`<img src="${s.img}"><p>${s.nombre}</p>`;
    c.onclick=()=>abrirOverlay(s);
    gridSistemas.appendChild(c);
  });
}

function volver(){
  document.getElementById("motos").classList.remove("hidden");
  document.getElementById("sistemas").classList.add("hidden");
}

function abrirOverlay(s){
  sistemaActual=s.nombre;
  imgBase.src=s.img;
  overlay.style.display="block";
  ajustarCanvas();
  cargarZonas();
}

function cerrar(){
  overlay.style.display="none";
  salirAdmin();
}

/* Canvas */
function ajustarCanvas(){
  canvas.width=imgBase.clientWidth;
  canvas.height=imgBase.clientHeight;
}

canvas.onmousedown=e=>{
  if(!admin) return;
  dibujando=true;
  puntos=[[e.offsetX,e.offsetY]];
  ctx.beginPath();
  ctx.moveTo(e.offsetX,e.offsetY);
};
canvas.onmousemove=e=>{
  if(!dibujando) return;
  puntos.push([e.offsetX,e.offsetY]);
  ctx.lineTo(e.offsetX,e.offsetY);
  ctx.strokeStyle="red";
  ctx.lineWidth=2;
  ctx.stroke();
};
canvas.onmouseup=()=>dibujando=false;

/* ADMIN */
function loginAdmin(){
  if(passAdmin.value!=="Neto30"){alert("Contrase√±a incorrecta");return;}
  admin=true;
  loginAdminDiv(true);
}

function salirAdmin(){
  admin=false;
  loginAdminDiv(false);
  ctx.clearRect(0,0,canvas.width,canvas.height);
}

function loginAdminDiv(on){
  document.getElementById("loginAdmin").classList.toggle("hidden",on);
  document.getElementById("adminPanel").classList.toggle("hidden",!on);
  document.getElementById("salirAdminBtn").classList.toggle("hidden",!on);
}

/* Zonas */
function keyLS(){return "ZONAS_"+motoActual+"_"+sistemaActual;}
function guardarZona(){
  zonas.push({puntos,codigo:codigo.value,desc:desc.value,cant:cant.value});
  localStorage.setItem(keyLS(),JSON.stringify(zonas));
  puntos=[];
  renderTabla();
}
function cargarZonas(){
  zonas=JSON.parse(localStorage.getItem(keyLS()))||[];
  renderTabla();
}
function renderTabla(){
  tabla.innerHTML="";
  zonas.forEach(z=>{
    tabla.innerHTML+=`<tr><td>${z.codigo}</td><td>${z.desc}</td><td>${z.cant}</td></tr>`;
  });
}
</script>

</body>
</html>
